import{r as o,j as e,R as B,a as n}from"./index-NyMrVquD.js";const T=()=>{const[i,u]=o.useState(""),[c,g]=o.useState(""),[b,h]=o.useState(null),[f,p]=o.useState(""),[x,d]=o.useState(""),[v,N]=o.useState(""),[y,w]=o.useState([]),j=o.useRef(null);o.useEffect(()=>{async function t(){try{const l=await n.get("/blog/allBlogs?page=1&limit=30");console.log(l.data),w(l.data)}catch(l){console.error("Error fetching blogs:",l)}}t()},[]);const C=async t=>{try{(await n.delete(`/blog/delete/${t}`,{withCredentials:!0})).ok?(w(s=>s.filter(r=>r._id!==t)),console.log("Blog deleted successfully!")):console.error("Failed to delete the blog")}catch(l){console.error("Error deleting the blog:",l)}},k=["header","bold","italic","underline","strike","blockquote","code-block","image","list","bullet","indent","link"];o.useEffect(()=>{const t=j.current.getEditor(),l=()=>{const s=document.createElement("input");s.setAttribute("type","file"),s.setAttribute("accept","image/*"),s.click(),s.onchange=async()=>{if(!s.files||!s.files.length||!s.files[0])return;const r=s.files[0],a=new FormData;a.append("img",r);try{const D=(await n.post("/blog/uploadImg",a,{withCredentials:!0},{headers:{"Content-Type":"multipart/form-data"}})).data.url,R=t.getSelection();t.insertEmbed(R.index,"image",D)}catch(m){console.error("Error uploading image:",m)}}};t.getModule("toolbar").addHandler("image",l)},[]);const E=t=>{const l=t.target.files[0];h(l),p(URL.createObjectURL(l))},S=async()=>{if(!i||!c||!b){d("Please fill in all fields.");return}const t=c.replace(/<img(.*?)src="(.*?)"(.*?)>/g,(s,r,a,m)=>`<img src="${a}" />`),l=new FormData;l.append("Title",i),l.append("description",t),l.append("cover",b);try{const s=await n.post("/blog/upload",l,{withCredentials:!0},{headers:{"Content-Type":"multipart/form-data"}});N("Blog post saved successfully!"),u(""),g(""),h(null),p(""),d("")}catch(s){console.error("Error saving blog post:",s),d("Failed to save the blog post. Please try again.")}};return e.jsx("div",{className:"container mx-auto p-4",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg",children:[e.jsx("h1",{className:"text-4xl font-bold mb-6 text-center",children:"Create a New Blog Post"}),x&&e.jsx("div",{className:"mb-4 p-4 bg-red-100 text-red-800 rounded-md",children:x}),v&&e.jsx("div",{className:"mb-4 p-4 bg-green-100 text-green-800 rounded-md",children:v}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg font-medium mb-2",htmlFor:"title",children:"Title"}),e.jsx("input",{id:"title",type:"text",value:i,onChange:t=>u(t.target.value),className:"w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter the title of the blog post"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg font-medium mb-2",htmlFor:"cover",children:"Cover Image"}),e.jsx("input",{id:"cover",type:"file",accept:"image/*",onChange:E,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:bg-blue-500 file:text-white hover:file:bg-blue-600"}),f&&e.jsx("img",{src:f,alt:"preview",className:"mt-4 w-full max-h-64 object-cover rounded-md"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-lg font-medium mb-2",children:"Description"}),e.jsx(B,{ref:j,value:c,onChange:g,modules:{toolbar:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","image","clean"]]},formats:k,className:"bg-white rounded-md"})]}),e.jsx("button",{onClick:S,className:"w-full py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-medium rounded-md hover:from-blue-600 hover:to-blue-700 transition-all duration-300",children:"Submit"}),e.jsx("div",{className:"bg-red-500 h-screen",children:y.map(t=>e.jsxs("div",{className:"p-4 mb-4 bg-white shadow-md",children:[e.jsx("h2",{className:"text-lg font-bold",children:t.Title}),e.jsx("button",{className:"mt-2 bg-red-700 text-white px-4 py-2 rounded",onClick:()=>C(t._id),children:"Delete"})]},t._id))})]})})};export{T as default};
